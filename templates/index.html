<div class="min-h-screen bg-neutral flex items-center justify-center">
  <div
    class="w-full max-w-xl rounded-2xl bg-white shadow-lg border border-neutral p-8"
  >
    <h1 class="text-3xl font-bold text-primary mb-2">FastAPI WebSocket Chat</h1>

    <h2 class="text-lg font-semibold text-muted mb-6">
      Your ID:
      <span
        id="ws-id"
        class="inline-block ml-2 px-3 py-1 rounded-lg bg-primary text-white text-sm"
      ></span>
    </h2>

    <form
      action=""
      onsubmit="sendMessage(event)"
      class="flex gap-3 items-center"
    >
      <input
        type="text"
        id="messageText"
        autocomplete="off"
        placeholder="Type your message..."
        class="flex-1 rounded-xl border border-neutral bg-neutral-100 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-primary"
      />

      <button
        type="submit"
        class="rounded-xl bg-primary px-6 py-3 font-bold text-white hover:bg-primary-800 active:scale-95 transition"
      >
        Send
      </button>
    </form>

    <ul id="messages" class="mt-8 space-y-3 max-h-64 overflow-y-auto"></ul>
  </div>
</div>

<script>
  var client_id = Date.now();
  document.querySelector("#ws-id").textContent = client_id;
  var ws = new WebSocket(`ws://localhost:8000/ws/${client_id}`);
  ws.onmessage = function (event) {
    var messages = document.getElementById("messages");
    var message = document.createElement("li");
    var content = document.createTextNode(event.data);
    message.appendChild(content);
    messages.appendChild(message);
  };
  function sendMessage(event) {
    var input = document.getElementById("messageText");
    ws.send(input.value);
    input.value = "";
    event.preventDefault();
  }
</script>
